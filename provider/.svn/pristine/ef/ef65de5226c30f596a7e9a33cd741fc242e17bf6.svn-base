function alertTip(e,t,n){t=t?t:400,n=n?n:"auto",$('<div title="提示(Tip)" id="dialog-auto-alert-tip"><p align="">'+e+"</p></div>").dialog({autoOpen:!0,width:t,height:n,modal:!0,show:"slide",buttons:[{text:"关闭(Close)",click:function(){$(this).dialog("close")}}],close:function(){$(this).detach()}})}function openIframeDialog(e,t,n,r){r=r?r:"",iframe='<iframe  class="dialogIframe" name="dialogIframe" scrolling="no" src="'+e+'"/>',$(iframe).dialog({autoResize:!0,resizable:!1,width:t+30,modal:!0,position:"top",title:r,close:function(){$(this).remove()}}).width(t).height(n)}function openIframeDialogNew(e,t,n,r,i,s,o,u){r=r==undefined?"[Esc]":r,iframe='<iframe  class="dialogIframe" name="dialogIframe" scrolling="no" src="'+e+'"/>',$(iframe).dialog({autoResize:!0,resizable:!1,width:t+30,modal:!0,position:"top",title:r,close:function(){u==1&&window.frames["iframe-container-"+i].loadData(s,o),$(this).remove()},open:function(){u=0}}).width(t).height(n)}function submitSearch(){initData(0)}function success(e){switch(e.state){case 1:initData(0),$(this).dialog("close"),dialogClose=1;break;case 2:loadData(paginationCurrentPage,paginationPageSize),dialogClose=1,alertTip(e.message);break;default:var t="",n=$("#validateTips");if(e.errorMsg==null)return;$.each(e.errorMsg,function(e,n){t+='<span class="tip-error-message">'+n+"</span>"}),n.html(t)}}function deleteById(e){if(e==""||e==undefined)return!1;$.EzWmsDel({paramId:e,Field:"paramId",url:EZ.url+"delete"},submitSearch)}function editById(e){EZ.editDialog.EzWmsEditDataDialog({paramId:e,url:EZ.url+"get-by-json",editUrl:EZ.url+"edit"})}function isJson(e){return typeof e=="object"&&Object.prototype.toString.call(e).toLowerCase()=="[object object]"&&!e.length}function loadData(e,t){EZ.listDate.myLoading(),$.ajax({type:"POST",async:!1,dataType:"json",url:EZ.url+"list/page/"+e+"/pageSize/"+t,data:EZ.searchObj.serializeArray(),error:function(){paginationTotal=0,EZ.listDate.EzWmsSetSearchData({msg:"The URL request error."});return},success:function(e){if(!isJson(e)){paginationTotal=0,EZ.listDate.EzWmsSetSearchData({msg:"Returns the data type error."});return}paginationTotal=e.total,e.state=="1"?EZ.listDate.html(EZ.getListData(e)):EZ.listDate.EzWmsSetSearchData({state:1})}})}function windowHeight(){return self.innerHeight?self.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body?document.body.clientHeight:0}function windowWidth(){return self.innerWidth?self.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:document.body?document.body.clientWidth:0}function leftMenu(e,t,n){$(window.parent.document).find(".main-right>.guild>h2").css("background","transparent");var r=$(window.parent.document).find(".main-right>.guild>h2").length;obj=window.parent.document.getElementById("menu"+e);var i;t.length>12?i=t.substring(0,12)+"...":i=t;if(obj==null){r>4&&saveAsMenu();var s="leftMenu('"+e+"'"+",'"+t+"','"+n+"')",o="closeMenu(this,'"+e+"')",u='<H2 style="cursor:pointer " id="menu'+e+""+'">';u+='<a style="float: left"  href="javascript:void(0)"',u=u+' onclick="'+s+'">'+i+"</a>",u=u+'<span style="font-size:18px;padding-left: 8px;padding-right:0px;color:darkgray;float: left; " onclick="'+o+'">×</span></H2>',$(window.parent.document).find(".main-right>.guild>h3").before(u)}else obj.style.background="#fff";var a="";a+='<iframe frameborder="0" src="'+n+'" width="100%" height="100%" id="iframe-container-'+e+'" name="iframe-container-'+e+'" class="iframe-container" ></iframe>';var f=$(window.parent.document).find(".iframe-container");f.hide(),obj=$(window.parent.document).find("#iframe-container-"+e),obj.size()>0?n!=obj.attr("src")?(obj.remove(),$(window.parent.document).find("#main-right-container-iframe").append(a)):obj.css("display","block"):$(window.parent.document).find("#main-right-container-iframe").append(a),f.size()>5&&f.eq(1).remove(),$.cookie("currentPage",e+"{|}"+n+"{|}"+t,{path:"/"})}function closeMenu(e,t){var n,r,i,s=$(e).parent().prev().children().attr("onclick"),o=s.split(",")[0];n=o.substring(o.indexOf("'")+1,o.length-1);var u=s.split(",")[1];r=u.substring(u.indexOf("'")+1,u.length-1);var a=s.split(",")[2];i=a.substring(a.indexOf("'")+1,a.length-2),$(e).parent().remove(),$(window.parent.document).find("#iframe-container-"+t).remove(),leftMenu(n,r,i)}function closeHisMenu(e){$(e).parent().remove()}function leftMenuHis(e,t,n){showHistory(),leftMenu(e,t,n)}function saveAsMenu(){var e=$(window.parent.document).find(".main-right>.guild>h2").eq(1).attr("id"),t=window.parent.document.getElementById("his"+e);if(t==null){var n="<h4 id=his"+e+">"+$(window.parent.document).find(".main-right>.guild>h2").eq(1).html()+"</h4>";n=n.replace("closeMenu","closeHisMenu"),n=n.replace("leftMenu","leftMenuHis"),$(window.parent.document).find(".main-right>.guild>h3>div").append(n)}$(window.parent.document).find(".main-right>.guild>h2").eq(1).remove()}function showHistory(){if($(window.parent.document).find(".main-right>.guild>h3>div>h4").length>0){var e=document.getElementById("menuList").style.display;e=="none"?(e="block",$("#menuList").css("display",e),$("#menuBtn").attr("src","/images/pack/bg_guild_drop02.gif")):(e="none",$("#menuBtn").attr("src","/images/pack/bg_guild_drop01.gif")),$("#menuList").css("display",e)}}function clearHis(e){$(window.parent.document).find(".main-right>.guild>h3>div>h4").remove(),$("#menuList").css("display","none"),$("#menuBtn").attr("src","/images/pack/bg_guild_drop01.gif")}function searchFilterSubmit(e,t,n){e!=null&&($("input[name="+e+"]","#searchForm").attr("value",t),$(n).parent().children("a").removeClass(),$(n).addClass("current"),submitSearch()),searchFilterAttr(e,t,n)}function searchFilterAttr(e,t,n){}function toAdvancedSearch(){$("#search-module-baseSearch").hide(),$(".input_text","#search-module-baseSearch").val(""),$("#search-module-advancedSearch").show()}function toBaseSearch(){$("#search-module-baseSearch").show(),$("#search-module-advancedSearch").hide(),$(".input_text","#search-module-advancedSearch").val("")}function showThisSubMenu(e,t){$(e).children().children("a").addClass("menuiconahover"),document.getElementById(t).style.display="block"}function closeThisSubMenu(e,t){$(e).children().children("a").removeClass("menuiconahover"),document.getElementById(t).style.display="none"}function autoHeight(){var e=$("#header").height(),t=windowHeight();t<600&&(t=600);var n=t-e-14;$("#sidebar").css("height",n),$("#sidebarIcon").css("height",n);var r=$("#menu-module");r.height()>n-150&&r.css("overflow-y","auto").css("height",n-150),$(".main-right-container").css("height",t-e-169)}var EC=$.myProject.attach({}),paginationTotal=10,paginationPageSize=20,paginationCurrentPage=1,EZ={version:"13.15.2."+(new Date).getDate(),exDate:(new Date).getDate(),edit:"编辑",del:"删除",search:"搜索",create:"添加",deleteMessage:"确定要删除吗？",searchMessage:"没有找到记录，请调整搜索条件。",searchDefaultMessage:"请搜索...",url:"",listDate:"",editDialog:"",searchObj:"",callback:function(){return""}};$(function(){EZ.listDate=$("#table-module-list-data"),EZ.editDialog=$("#ez-wms-edit-dialog"),EZ.searchObj=$("#searchForm"),$(".keyToSearch").keyup(function(e){var t=e.which;if(t==13)try{submitSearch()}catch(n){alertTip(n)}}),$(".submitReturnFalse").submit(function(){return!1})}),jQuery.fn.EzWmsSetSearchData=function(e){var t={msg:EZ.searchDefaultMessage,state:0},e=$.extend(t,e);e.state=="1"&&e.msg==EZ.searchDefaultMessage&&(e.msg=EZ.searchMessage),($(this).children("tr").length<1||e.state=="1")&&$(this).html('<tr class="table-module-b1"><td colspan='+$(this).prev().children("tr").children("td").length+">"+e.msg+"</td></tr>"),$(".pagination").html("")},jQuery.fn.EzCheckAll=function(e){$(this).is(":checked")?e.attr("checked",!0):e.attr("checked",!1)},$.EzWmsConfirmDialog=function(e,t,n){var r={funData:[],paramId:0,dWidth:"400",dHeight:"auto",dTitle:"提示(Tip)",dMessage:EZ.delMessage},e=$.extend(r,e);$('<div title="'+e.dTitle+'" class="dialog-confirm-alert-tip">'+e.dMessage+"</div>").dialog({autoOpen:!0,width:e.dWidth,height:e.dHeight,modal:!0,show:"slide",buttons:{"确定(Ok)":function(){typeof t=="function"&&t(e.paramId),$(this).dialog("close")},"取消(Cancel)":function(){typeof n=="function"&&n(),$(this).dialog("close")}},close:function(){$(this).detach()}})},$.EzWmsDel=function(e,t,n){var r={funData:[],Field:"id",paramId:0,url:"/",dWidth:"400",dHeight:"auto",dTitle:"提示(Tip)",successMsg:"",dMessage:EZ.deleteMessage},e=$.extend(r,e);$('<div title="'+e.dTitle+'" class="dialog-confirm-del-alert-tip"><p style="text-align:left;font-size: 14px;color: red;font-weight: bold;">'+e.dMessage+"</p></div>").dialog({autoOpen:!0,width:e.dWidth,height:e.dHeight,modal:!0,show:"slide",buttons:{"确定(Ok)":function(){$.ajax({type:"post",async:!1,dataType:"json",url:e.url,data:e.Field+"="+e.paramId,success:function(n){var r=n&&n.state?n.state:0,i=n&&n.message?n.message:e.successMsg;r&&typeof t=="function"&&t(),alertTip('<p style="text-align:left;font-size: 14px;color: red;font-weight: bold;">'+i+"</p>")}}),$(this).dialog("close")},"取消(Cancel)":function(){typeof n=="function"&&n(),$(this).dialog("close")}},close:function(){$(this).detach()}})},jQuery.fn.EzWmsEditDataDialog=function(e){var t={jsonData:{},Field:"paramId",paramId:0,url:"/",editUrl:"/",dWidth:"550",dHeight:"auto",dTitle:"系统操作/Operations",successMsg:""},e=$.extend(t,e),n=$(this);$('<div title="'+e.dTitle+'" id="dialog-edit-alert-tip" class="dialog-edit-alert-tip"><form id="editDataForm" name="editDataForm" class="submitReturnFalse">'+n.html()+'</form><div class="validateTips" id="validateTips"></div></div>').dialog({autoOpen:!0,width:e.dWidth,height:e.dHeight,modal:!0,show:"slide",buttons:[{text:"确定(Ok)",click:function(){if(e.editUrl=="/")return;$("#editDataForm").submit()}},{text:"取消(Cancel)",click:function(){$(this).dialog("close")}}],close:function(){$(this).detach()}});var r=function(){$.ajax({type:"post",async:!1,dataType:"json",url:e.url,data:e.Field+"="+e.paramId,success:function(e){e.state&&$.each(e.data,function(e,t){$("[name="+e+"]","#dialog-edit-alert-tip").val(t)})}})},i=function(e){switch(e.state){case 1:$("#dialog-edit-alert-tip").dialog("close"),initData(0);break;case 2:$("#dialog-edit-alert-tip").dialog("close"),loadData(paginationCurrentPage,paginationPageSize),alertTip(e.message);break;default:var t="",n=$("#validateTips");if(e.errorMessage==null)return;$.each(e.errorMessage,function(e,n){t+='<span class="tip-error-message">'+n+"</span>"}),n.html(t)}};e.url!="/"&&e.paramId!="0"&&r(),$("#editDataForm").myAjaxForm({api:e.editUrl,success:i})},$(function(){autoHeight()});var resizeTimer=null;window.onresize=function(){resizeTimer=resizeTimer?null:setTimeout(autoHeight,0)}