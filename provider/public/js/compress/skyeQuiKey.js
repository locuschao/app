EC.addMods({column:function(){var e=this,t=this.urlParams,n=this.$element,r,i,s,o=EZ.userId,u="",a="SkyeQuiKeyData_",f="";this.init=function(){r=function(e){$.ajax({type:"POST",dataType:"json",url:"/default/system/get-Skye-Qui-Key",success:function(t){t.state=="1"&&isJson(t)?(u=t.data,e(""),sessionStorage&&typeof JSON!="undefined"&&(sessionStorage.setItem("version",EZ.version),sessionStorage.setItem(a+t.userId,JSON.stringify(u)))):(f+='<dl><a href="javascript:void (0);" id="SkyeQuiKey"><dt><img src="/images/header/icon_nav088.png"/></dt><dd>添加</dd></a></dl>',n.parents().find(".nav2").html(f),$("#SkyeQuiKey").click(function(){i()}))}})},s=function(e){f="",e=e==""?u:e,$.each(e,function(e,t){f+="<dl>",f+='<a href="javascript:void(0)" onclick=\'leftMenu("'+t.urlId+'","'+t.title+'","'+t.url+"?quick="+t.urlId+"\")'>",t.icon!=""?f+=' <dt><img src="/images/header/'+t.icon+'"/></dt>':f+=' <dt><img src="/images/header/20120326105253418.png"/></dt>',f+="<dd>"+t.title+"</dd></a>",f+="</dl>"}),f+='<dl><a href="javascript:void (0);" id="SkyeQuiKey"><dt><img src="/images/header/icon_nav088.png"/></dt><dd>添加</dd></a></dl>',n.parents().find(".nav2").html(f),$("#SkyeQuiKey").click(function(){i()})};if(sessionStorage&&typeof JSON!="undefined"){var e=sessionStorage;e.getItem(a+o)&&e.getItem(a+o)!="undefined"&&e.getItem(a+o)!=""&&e.getItem("version")==EZ.version?(u=JSON.parse(e.getItem(a+o)),s(u)):r(s)}else r(s)},i=function(){var e="";checkAll=function(e){var t=$(e).attr("ref");$(e).attr("checked")=="checked"?$("."+t).attr("checked","true"):$("."+t).attr("checked",!1)},$.ajax({type:"POST",async:!1,dataType:"json",url:"/default/system/get-Skye-Qui-Key-list",success:function(t){if(isJson(t)&&t.state=="1"){var n=t.data,r="",i="",s="";$.each(n,function(t,o){o.menu_id!=r&&(o.menu_id!=r&&r!=""&&(e+="</div>"),r=o.menu_id,e+="<div class='url-module'>",e+='<input type="checkbox" onclick="checkAll(this)" ref="checkbox'+r+'"><span class="url-module-title"  ref="'+r+'" >&nbsp;&nbsp;'+o.menu+"</span>",e+="</div>",e+="<div class='url-Box action_"+r+"'>"),i=o.selected=="1"?"url-checked":"",s=o.selected=="1"?"checked":"",e+="<div class='url-Box'><label>",e+="<input type='checkbox' value='"+o.id+"' "+s+"  name='actionId["+o.id+"]' class='shortcutsKey checkbox"+r+"' /><span class='"+i+"'>"+o.title+"</span>",e+="</label></div>",t==n.length-1&&(e+="</div>")})}}}),$('<div title="快捷导航" id="dialog-SkyeQuiKey-alert-tip"><form id="editSkyeQuiKeyForm" name="editSkyeQuiKeyForm" class="submitReturnFalse">'+e+"</form></div>").dialog({autoOpen:!0,width:650,modal:!0,show:"slide",buttons:[{text:"确定(Ok)",click:function(){if($(".shortcutsKey:checked").size()>6)return alertTip("只允许绑定六个以内."),!1;$.ajax({type:"POST",async:!1,dataType:"json",data:$("#editSkyeQuiKeyForm").serializeArray(),url:"/default/system/update-Skye-Qui-Key",success:function(e){isJson(e)&&e.state=="1"?(sessionStorage&&sessionStorage.removeItem(a+o),r(s)):alertTip("操作失败.")}}),$("#dialog-SkyeQuiKey-alert-tip").dialog("close")}},{text:"取消(Cancel)",click:function(){$(this).dialog("close")}}],close:function(){$(this).detach()}}),$(".url-module-title").click(function(){var e=$(this).attr("ref"),t=$(".action_"+e);t.css("display")=="none"?t.show():t.hide()})}}})