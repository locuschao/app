(function(e){var t=function(t){var n=this,r=this.nextAll(".msg");r.length==0&&(r=e("<span class='msg'></span>").appendTo(n.parent())),t.length>0?r.removeClass("valid-msg").addClass("err-msg").html(t.join(",")):r.removeClass("err-msg").addClass("valid-msg").html("")},n=function(e){var t=[];e.fields.each(function(){t.push(r.call(this,e))});var n=[];for(var i=0;i<t.length;i++){var s=t[i];s.msg.length>0&&n.push(s.field.attr("name")+s.msg)}return n.length==0?!0:!1},r=function(n){var r=e(this),i=o.call(r),s=r.attr("err-msg")?r.attr("err-msg").split("|"):null,u=r.attr(n.validatorAttrName).split(" "),l=[];for(var c=0;c<u.length;c++){var h=u[c],p=h.replace("]","").replace("[",",").split(","),d=p[0];p[0]=i;if(a[d]&&!a[d].apply(r,p)){var v=s&&s.length>c&&s[c]!=""?s[c]:f[d];if(v){for(var m=0;m<p.length;m++){var g=p[m];v=v.replace(new RegExp("\\{"+m+"\\}","ig"),p[m])}l.push(v)}}}return t.call(r,l),{field:r,msg:l}},i=function(t){var i=this;i.submit(function(){return setTimeout(function(){n.call(i,t)&&e.post(t.url||l(t.api)||i.attr("action"),i.serialize(),function(e){t.success&&t.success.call(i,e)},"json")},0),!1}),t.fields=i.find("["+t.validatorAttrName+"]").each(function(){var n=e(this);n.focus(function(){}),n.blur(function(){var e=o.call(n),i=n.attr("original-val");i!=e&&(n.attr("original-val",e),r.call(this,t))})})},s=function(e){var t=e.attr("tagName")?e.attr("tagName").toLocaleLowerCase():e[0].tagName.toLocaleLowerCase();if(t=="input"){var n=e.attr("type").toLocaleLowerCase();return n}return t},o=function(){var e=this,t=u[s(e)]?u[s(e)].call(e):e.val();return t},u={checkbox:function(){var e=this.closest("form"),t=e.find(":checkbox[name='"+this.attr("name")+"']:checked");return t.length==0?"":t.val()}},a={required:function(e){return e==""?!1:!0},integer:function(e){return/^\d+$/.test(e)},numeric:function(e){return/^([1-9][0-9]*|0)(\.[0-9]+)?$/.test(e)},length:function(e,t,n){var r=e.length,i=!(r<t*1||n&&r>n*1);return i},min:function(e,t){return e>t*1},max:function(e,t){return e<t*1},email:function(e){var t=/^(([\-\w]+)\.?)+@(([\-\w]+)\.?)+\.[a-zA-Z]{2,4}$/.test(e);return t},regexp:function(e,t,n){var r=new RegExp(t),i=r.test(e);return i}},f={required:"不能为空",length:"长度必须为{1}到{2}",email:"邮箱格式不正确",numeric:"必须是数字",integer:"必须是整数",min:"必须是小于{1}的数字",max:"必须是大于{1}数字",regexp:"数据不正确"},l=function(t){var n=t.split("."),r=e.myAjaxForm.api;for(var i=0;i<n.length;i++){if(!r)break;var s=n[i];r=r[s]}return r||(r=t.replace(/\./g,"/")),e.myAjaxForm.global.apiPath+r};e.myAjaxForm=function(){return{}}(),e.myAjaxForm.global={fieldValue:u,apiPath:"",type:"post",validatorAttrName:"validator"},e.myAjaxForm.api={};var c={init:function(t){this.each(function(){var n=e.extend({},e.myAjaxForm.global,t);i.call(e(this).addClass("my-ajax-form"),n)})}};e.fn.myAjaxForm=function(t){if(c[t])return c[t].apply(this,Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t)return c.init.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.tooltip")}})(jQuery)